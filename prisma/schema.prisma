datasource db {
  provider = "sqlserver" 
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  colegiado String  @unique  
  name      String
  email     String   @unique  
  dpi       String   @unique  
  birthDate DateTime
  password  String
  role      String   // Puedes definir roles más específicos si es necesario
  votes     Vote[]   // Relación con los votos
}

model Campaign {
  id          Int      @id @default(autoincrement())
  title       String
  description String
  isActive    Boolean   @default(true) // Cambié el tipo de BIT a Boolean
  votes       Vote[]    // Relación con los votos
}

model Candidate {
  id         Int      @id @default(autoincrement())
  name       String
  campaignId Int
  campaign   Campaign @relation(fields: [campaignId], references: [id]) // Asegúrate de que esta relación esté definida
}

model Vote {
  id         Int       @id @default(autoincrement())
  userEmail  String    // Referencia al correo del votante
  candidateId Int
  campaignId Int
  user       User      @relation(fields: [userEmail], references: [email])
  candidate  Candidate @relation(fields: [candidateId], references: [id])
  campaign   Campaign  @relation(fields: [campaignId], references: [id])
  @@unique([userEmail, campaignId]) // Asegura que el mismo usuario no vote más de una vez por campaña
}
